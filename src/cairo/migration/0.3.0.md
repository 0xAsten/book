## Migration Guide to 0.3.0

### Components to Models

In version 0.3.0, "components" have been renamed to "models".

- Replace `#[component]` with `#[model]`.
- Update `#[derive(Component)]` to `#[derive(Model)]` throughout your code.

**Note**: Ensure all related files and imports are updated accordingly.

### Changes in Model Implementation

The trait `SerdeLen` is no longer implemented for models. If you relied on this previously, you should now use `SchemaIntrospection`.

_TODO_: Determine if the implementation requires `SchemaIntrospection`.

### Systems Update

#### Interface Creation

System management has been revamped. Start by defining an interface for each system, which specifies its implementation:

```rust
#[starknet::interface]
trait ICreateCard<TContractState> {
    fn create_card(
        self: @TContractState,
        world: IWorldDispatcher,
        token_id: u256,
        dribble: u8,
        defense: u8,
        cost: u8,
        role: Roles,
        is_captain: bool
    );
}
```

Ensure the trait is typed with `TContractState`.

**Note**: Earlier versions required functions within the system to be named `execute`. This is no longer the case.

#### Interface Implementation

To implement the interface:

1. Add `#[external(v0)]` before each method.
2. Ensure to reference the created interface in the module with `use super::ICreateCard;`.

```rust
#[external(v0)]
impl CreateCardImpl for ICreateCard<ContractState> {
    fn create_card(
        self: @ContractState,
        world: IWorldDispatcher,
        token_id: u256,
        dribble: u8,
        defense: u8,
        cost: u8,
        role: Roles,
        is_captain: bool
    ) {
        // your logic here
    }
}
```

#### Events Migration

Events should now reside within the models. Here's an example of how to migrate your events:

**New Format**:

```rust
#[event]
#[derive(Copy, Drop, starknet::Event)]
enum Event {
    DeckCreated(DeckCreated)
}

#[derive(Copy, Drop, starknet::Event)]
struct DeckCreated {
    player: ContractAddress,
    token_list: Span<u256>,
}
```

**Previous Format**:

```rust
#[derive(Drop, starknet::Event, Copy)]
struct DeckCreated {
    player: ContractAddress,
    token_list: Span<u256>,
}
```

### Testing Changes

#### Setup

Testing has seen significant changes. Instead of using `world.execute`, use the dispatcher.

1. Import necessary modules and traits:

```rust
use dojo::test_utils::deploy_contract;
use tsubasa::systems::{ICreateCardDispatcher, ICreateCardDispatcherTrait};
```

2. Deploy the contract and instantiate the dispatcher:

```rust
let contract_create_card = deploy_contract(
    create_card_system::TEST_CLASS_HASH, array![].span()
);
let create_card_system = ICreateCardDispatcher { contract_address: contract_create_card };
```

#### Function Testing

With the contract deployed and the dispatcher instantiated, proceed to test your functions:

```rust
// ... (previous setup code)

let result = create_card_system.create_card(
    // ... provide necessary parameters here
);

// Assert or validate the 'result' as per your test conditions
```
